@model Coevery.Fields.Fields.DatetimeField
@using Coevery.Utility.Extensions;
@using Coevery.Fields.Settings;
@{
    var settings = Model.PartFieldDefinition.Settings.GetModel<DatetimeFieldSettings>();
    var required = settings.Required ? "required" : null;
}

<label class="control-label title @required" for="@Html.FieldIdFor(m => m.Value)">@Model.DisplayName</label>
<div class="control controls input-prepend errortips">
    <span class="add-on">
        <i data-time-icon="icon-time" data-date-icon="icon-calendar"></i>
    </span>
    <input class="date" type="text" 
           id="@Html.FieldIdFor(m => m.Value)" 
           name="@Html.FieldNameFor(m => m.Value)" 
           value="@Model.Value" 
        @if (required != null) {<text> required data-msg-required="Please fill this field!"</text> } 
        @if (!string.IsNullOrWhiteSpace(settings.HelpText)) {<text>helper:text='@settings.HelpText'</text> }
        />
    @Html.ValidationMessageFor(m => m.Value)


</div>

<script type="text/javascript">
    $(function () {
        var defaultDate = $("#@Html.FieldIdFor(m => m.Value)");
            if (defaultDate.length != 0) {
                defaultDate.parent().datetimepicker();
            @if (Model.Value.HasValue) {
            <text>var date = new Date('@Model.Value.Value'); defaultDate.parent().data('datetimepicker').setLocalDate(date);</text> }
        }
        });
</script>

@Display.DateTimePickerLocalization()